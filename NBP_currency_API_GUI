import tkinter as tk
from tkinter import ttk
from tkinter import messagebox
import requests

URL = 'http://api.nbp.pl/api/exchangerates/tables/A/'
table = requests.get(URL)
response = table.json()
     

class CurrencyConverter(tk.Tk):
    def __init__(self):
        tk.Tk.__init__(self)

        self.title("Kalkulator Walut")
        self.geometry("260x300")
        self.resizable(False, False)

        self.label_title = ttk.Label(self, text="Kalkulator Walut", font=("TkDefaultFont", 16))
        self.label_title.pack(pady=10)

        self.label_code = ttk.Label(self, text="Podaj symbol waluty:")
        self.label_code.pack(pady=5)

        self.combobox_code = ttk.Combobox(self, values=[rate['code'] for rate in response[0]['rates']], state="readonly")
        self.combobox_code.pack(pady=5)

        self.label_amount = ttk.Label(self, text="Podaj kwotÄ™:")
        self.label_amount.pack(pady=5)

        self.entry_amount = ttk.Entry(self)
        self.entry_amount.pack(pady=5)

        self.button_calculate = ttk.Button(self, text="Przelicz", command=self.calculate)
        self.button_calculate.pack(pady=5)

        self.label_result = ttk.Label(self, text="")
        self.label_result.pack(pady=5)

        self.button_close = ttk.Button(self, text="Zamknij", command=self.destroy)
        self.button_close.pack(side="right", padx=5, pady=5)
        self.button_about = ttk.Button(self, text="O programie", command=self.about)
        self.button_about.pack(side="left", padx=5, pady=5)

    def calculate(self):
        currency_code = self.combobox_code.get()
        amount = float(self.entry_amount.get())

        for rate in response[0]['rates']:
            if currency_code == rate['code']:
                price_mid = float(rate['mid'])
                result = amount * price_mid
                self.label_result.config(text=f'Po przeliczeniu: {result:.2f} PLN')

    def about(self):
        messagebox.showinfo("O programie", "Kalkulator Walut v1.0\nAutor: Ramzeez88 . Na podstawie kodu od AdamR77")


if __name__ == "__main__":
    app = CurrencyConverter()
    app.mainloop()
